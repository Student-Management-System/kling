<div class="directory">
	<button
		mat-button
		disableRipple="true"
		[contextMenu]="directoryContextMenu"
		(click)="toggleIsExpanded()"
		(middleclick)="toggleIsExpanded()"
	>
		<app-icon name="expand_more" size="18" class="ml-[-2px]" *ngIf="isExpanded"></app-icon>
		<app-icon name="chevron_right" size="18" class="ml-[-2px]" *ngIf="!isExpanded"></app-icon>
		<app-icon name="folder" size="18" class="pl-1 pr-2 folder-icon"></app-icon>
		<span class="directory-name">{{ directory.name }}</span>
	</button>

	<context-menu #directoryContextMenu>
		<ng-template contextMenuItem (execute)="workspaceDialogs.openCreateFileDialog(directory)">
			<span class="context-menu-item"
				><app-icon name="note_add" class="icon-light"></app-icon
				>{{ "Action.Custom.AddFile" | translate }}</span
			>
		</ng-template>
		<ng-template
			contextMenuItem
			(execute)="workspaceDialogs.openCreateDirectoryDialog(directory)"
		>
			<span class="context-menu-item"
				><app-icon name="create_new_folder" class="icon-light"></app-icon
				>{{ "Action.Custom.AddDirectory" | translate }}</span
			>
		</ng-template>
		<ng-template contextMenuItem (execute)="rename()">
			<span class="context-menu-item"
				><app-icon name="edit" class="icon-light"></app-icon
				>{{ "Action.Rename" | translate }}</span
			>
		</ng-template>
		<ng-template contextMenuItem (execute)="removeDirectoryIfConfirmed()">
			<span class="context-menu-item"
				><app-icon class="icon-light" name="delete"></app-icon
				>{{ "Action.Delete" | translate }}</span
			>
		</ng-template>
	</context-menu>

	<div class="indent directory-content" *ngIf="isExpanded">
		<div class="files">
			<ng-container *ngFor="let file of files$ | async">
				<app-file [file]="file" [isSelected]="selectedFile?.path === file.path"></app-file>
			</ng-container>
		</div>

		<div class="directories">
			<ng-container *ngFor="let dir of directories$ | async">
				<app-directory [directory]="dir" [selectedFile]="selectedFile"></app-directory>
			</ng-container>
		</div>
	</div>
</div>
