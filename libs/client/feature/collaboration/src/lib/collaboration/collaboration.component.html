<div
	class="flex flex-col justify-between h-full gap-2 p-4 overflow-hidden"
	*ngIf="{ activeSessionId: activeSessionId$ | async } as obs"
>
	<div class="flex flex-col flex-grow-0 gap-4">
		<div class="flex justify-between">
			<span class="text-xl">Collaboration</span>
			<button
				*ngIf="obs.activeSessionId"
				class="p-1 text-white bg-purple-600 rounded"
				(click)="disconnect()"
			>
				Disconnect
			</button>
		</div>

		<div class="flex flex-col gap-2">
			<span class="">Copy the URL and share it with your mates!</span>

			<div class="flex gap-2" *ngIf="obs.activeSessionId; else noSession">
				<input [value]="shareUrl" class="w-full p-1 bg-gray-600 rounded" />
				<button (click)="copyToClipboard(shareUrl!)">
					<kling-icon name="file_copy" size="18"></kling-icon>
				</button>
			</div>

			<ng-template #noSession>
				<button class="p-1 text-white bg-purple-600 rounded" (click)="createSession()">
					Create Session
				</button>
			</ng-template>
		</div>

		<div class="flex flex-col gap-2">
			<span class="text-lg">Collaborators</span>
			<div
				class="p-2 bg-gray-700 rounded"
				*ngFor="let collaborator of collaborators$ | async"
			>
				{{ collaborator.user.displayName }}
			</div>
		</div>

		<div class="flex flex-col flex-initial flex-grow-0 h-full gap-2">
			<span class="text-lg">Chat</span>
			<div class="flex flex-col flex-initial flex-grow-0 gap-2 overflow-scroll">
				<div class="flex bg-gray-700 rounded" *ngFor="let message of messages$ | async">
					<div class="h-full p-2 bg-gray-800 rounded-l">
						{{ message.user.displayName }}
					</div>
					<div class="p-2">{{ message.message }}</div>
				</div>
			</div>
		</div>
	</div>

	<div class="flex flex-col gap-2">
		<textarea rows="3" class="bg-transparent rounded ring ring-gray-500"></textarea>
		<button class="p-1 text-white bg-purple-600 rounded">Send</button>
	</div>
</div>
